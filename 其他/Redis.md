##### AOF.RDB和复制时对过期键的处理

- 执行save命令或bgsave时，程序会检查键，已经过期的key不会被保存在新创建的RDB文件中。
- 主服务器载入RDB文件时，程序也会检查键，过期键会被忽略。从服务器载入RDB文件时，不会检查键，过期键也会被载入。
- AOF如果某个键过期了，没有被惰性删除或者定期删除，AOF文件不会受到任何影响，如果删除了，会向AOF文件追加删除命令。AOF重写时，过期的键不会被写入。
- 从服务器不会对过期键检查，客户端可以反复在从服务器处获取已过期键的值，只要主服务器没有删除，从服务器也不会删除，这是为了保证一致性。

##### **用于限流**

1.使用list类型作为令牌桶限流方式，定期push令牌进去，拿到令牌才可以成功发起请求（list大小固定）。
2.INCR的同时设置超时时间，达到限流效果，比如设定阈值QPM为1000，设置超时时间1min , 请求进来先调用incr命令，如果返回值大于1000说明限流了，进行降级或者定期轮询重试。 小于1000则正常处理请求。（INCR返回1的时候说明上一次限流key刚过期，再重新设置过期间隔）

##### 缓存使用三种模式

1)旁路缓存
先更新数据库后删除缓存 
2)读写穿透	
先更新缓存，再由缓存服务更新数据库（因为redis不支持，所以用的很少）
3)异步缓存写入
先更新缓存，每隔一定时间或者缓存大小达到阈值才更新数据库，比如数据库系统和消息队列中使用。
