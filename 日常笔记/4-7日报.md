###### Spring boot WebMVC

项目中一般把状态码放在Response Body响应内容中返回。 在全局统一返回里，至少需要定义三个字段：code data message。通过一个统一对象序列号成json返回。 一般可以创建一个全局返回处理器，实现

```java
@ControllerAdvice(basePackages = "com.xixikun.控制器包名.controller")
public class GlobalResponseBodyHandler implements ResponseBodyAdvice
```

统一对返回的对象处理。 然后就是全局异常处理，可以通过先创建一个枚举类，存放错误码和错误信息。使用的时候直接使用枚举对象获取属性，增强代码可读性。

```java
@ControllerAdvice(basePackages = "com.xixikun.包名.controller")
public class GloableExceptionHandler

@ResponseBody
@ExceptionHandler(value = xxxException.class)
public 返回对象 exceptionHandler(HttpServletRequest req,Exception e)
```

Maven

```xml
对于父项目
<dependencyManagement>标签 子项目默认不继承，子项目可以直接使用dependence而不用指明版本号，指明版本号可以单独使用对应的版本。
<dependecencies>标签，子项目默认全部继承。
```



mybatis

Mapper接口中的方法里面的参数要添加@Param注解，方法一般命名为**动词 + by +查询条件**字段。













业务相关

1）标签相关

1. 标签类型（一个话题 一种商品 一种风格）
2. 具体标签（只能在一个分类下，不能重复） 按照设计，一个具体标签下默认有4个帖子（a.高热度 b.人工设置精选贴 c.帖子是否要审核 审核的时候设置），可以点击查看更多帖子。 
3. 具体帖子

主页面显示全部标签类型，点击类型显示当前类型下所有子标签，点击子标签显示相关帖子内容。

帖子里有一个大卡片展示与内容关联的标签，最大关联标签不超过5个。 

- 推测帖子标签应该由用户自己增删改 ，管理端可以修改任何帖子的标签。
-  标签应该有唯一标识，比如标签名字改了，相关帖子的标签也会修改 ，保证帖子能被筛选标签找到。
-  帖子标签信息id name应该被缓存在Jimdb ，使用旁路缓存,数据表中存储的是标签id。 jimdb里对每个大标签对应一个map，map里有子标签的kv值,k为标签名,v为标签id，查询时根据用户筛选的标签找出id，通过id找帖子列表。

2）个人资料

1. 名称默认用用户微信名称，获取失败就使用 “默认名称”的字串， 名称可自行编辑。长度控制，规范校验。
2. 头像同名称。
3. 性别年龄签名默认不显示，可以自行设置。
4. 每个用户生成一个FAN码，保证每个用户唯一（opininid生成 ）。用来加好友。别人看不到自己的。
5. 账号状态/标识：
   封禁（发布违规信息）1000
   普通状态（普通用户） 0100
   认证账号  0010
   官方账号   0001
   例如：封禁的官方认证账号：1011 =  13
6. 粉丝相关
   用户之间可以相互关注，任意用户只能看到自己的粉丝列表，只能看前N页粉丝。 可以看到自己的关注列表，其他人的不可见。
7. 总点赞，临时存储在jimdb，定期更新。
8. 卡片/瀑布流形式展示我的帖子，或者其他人主页的。卡片中包含图，点赞数评论数。按时间倒序。
9. 我喜欢的（收藏/点赞）喜欢的内容以瀑布流展示,卡片和上述相同，但多出作者名称头像内容。按时间倒序。他人的主页可以看到他人喜欢的内容。（一定限制 只显示部分）
10. 轨迹，轨迹需要频繁添加，先加入jimdb再定时更新数据库，记录 登录|表明态度|评论|点赞|发帖|关注|参与活动|收到回复|邀请好友|。这些消息都可以进行点击跳转到对应页面。
11. 第一次发帖需要邀请码，输入后永久开启发帖功能，发出的贴还需要经过审核。邀请码可以随机生成然后放在一个不可重复消费的消息队列里（请求量不大直接放在数据库），每次使用一个少一个。或者实时生成的，生成后放jimdb里面的list里，作为队列使用，类似于令牌桶。



3)具体内容

1. 主页是个大卡片 包含一定的内容，推测为一个热门帖子的摘要。每个用户打开小程序随机从热门帖子里筛选出一个帖子出来，或者针对用户感兴趣的标签的帖子。
   1. 主题从帖子中摘取。
   2. 然后是主题图片或者视频，如果是视频需要标记。 这部分主体可以看到弹幕形式的评论，弹幕可以点赞关闭举报，看情况审核。视频点击播放，图片点击查看大图。
   3. 再是贴主相关信息。点击进入个人主页。
   4. 帖子标签+截取的部分文字+点赞数，感觉这块是可以点击的，因为这块区域比较大，点击进入帖子。
   5. 三个按钮，（评论） 分享 点赞 。

2.帖子

1. 帖主相关信息+发布时间，可以关注，取关，点击文字部分跳转主页，如果是自己的帖子，这里有个小按钮可以管理自己的帖子，（编辑）删除等。
2. 标签+具体内容
3. 图片/视频 + 其他内容
4. 关联信息：店铺链接/其他链接
5. 评论框+发送按钮+点赞按钮+分享按钮，这里还会展示具体数量。

