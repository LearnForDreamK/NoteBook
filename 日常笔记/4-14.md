1.用单元测试跑通了获取粉丝列表接口，获取关注列表接口，自己他人发布的帖子，点赞的帖子列表接口，加入了登录态校验注解，方法日志注解，更新了预发环境的项目。

2.滨哥提示代码很多位置存在不规范问题，修改了全部实体的id属性，修改了相关方法的参数名，修改了多处局部变量的命名，保证命名能见名知意，修改了所有依赖注入的注解，把autowrited改为了resources，对类变量加上了注释，移除了接口中方法前面的public修饰符。返回类实体和数据库接收实体里面的基础类型字段都改为了包装类型， 移除了一些之前没有删除的被替换的方法，最后进行了单元测试，均没有出现问题。

3.初步完成了关注/取关接口的设计，完成了相关服务的逻辑实现。内容主题总结会。

明日计划：

完成关注/取关接口的实现。



学习点：

##### 登录态处理方案

登录校验通过自定义接口和AOP实现，在需要校验的接口上添加自定义注解，然后AOP会在这之前调用检测方法，根据加密的用户标识（cookie）查询用户登录信息，再把用户信息存入上下文中，供调用方法内部使用，检测方法内部再执行调用逻辑方法，最后移除上下文中的用户信息。

##### 多表查询处理方案

通常一些情况需要联表查询，但联表查询效率低下，通常是先查询一个表的数据，然后通过这个表的数据集合多次查询其他数据。 在所有查询过程中，都可能利用到缓存，查询数据前线查询缓存，没有时再查询数据库，把数据加入到缓存中。 比如查询关注用户列表，先查询所有关注的用户id，再通过id依次查询用户信息，包装到视图实体返回。

##### 操作频繁数据分表+中间件+缓存处理

比如一个帖子的点赞数，不可能每次点赞都操作数据库，点赞请求先发到MQ中，然后再放入缓存，再定期更新数据库。避免反复操作数据库。 查询帖子点赞数量时，不可能每次都计算，应该先查询缓存，没有再查数据库。

##### 技术相关

```java
1.通过JSONObject灵活转换API请求参数为自定义的参数对象。
2.通过ThreadLocal临时存放上下文对象，比如用户信息。
```

##### Lombok

绝大多数java包都工作在运行时，而Lombok是工作在编译时，其在编译时修改了语法树，相当于在编译时修改了代码，因此从直观上看，源代码甚至是语法有问题的，导致即使导入了相关包，一般的IDE无法识别Lombok的语法，所以才需要引入Lombok的插件。

##### 疑问

```mysql
#表A和表B通过主键内连接查询数据
SELECT * FROM A INNER JOIN B
ON A.id = B.id AND
#这里如果有一条件
B.properties = #{params}
# 查询时是不是先走B的索引查询properties，根据筛选出来的结果再和表A进行连接。
```

##### REST

**表现层状态转换**（[英语](https://zh.wikipedia.org/wiki/英语)：**Representational State Transfer**，[缩写](https://zh.wikipedia.org/wiki/縮寫)：**REST**）是[Roy Thomas Fielding](https://zh.wikipedia.org/w/index.php?title=Roy_Thomas_Fielding&action=edit&redlink=1)博士于2000年在他的博士论文[[1\]](https://zh.wikipedia.org/wiki/表现层状态转换#cite_note-Fielding-Ch5-1)中提出来的一种[万维网](https://zh.wikipedia.org/wiki/万维网)[软件架构](https://zh.wikipedia.org/wiki/软件架构)风格，目的是便于不同软件/程序在网络（例如互联网）中互相传递信息。表现层状态转换是根基于[超文本传输协议（HTTP）](https://zh.wikipedia.org/wiki/超文本传输协议)之上而确定的一组约束和属性，是一种设计提供万维网络服务的[软件构建风格](https://zh.wikipedia.org/wiki/軟件架構)。

##### 规范问题

- 返回类实体和数据库接收实体内基础类型字段应使用包装类型。
- 接口中方法无需添加修饰符。



##### 其他

1. Resources是J2EE提供的注解，降低了和Spring的耦合，可以通过名称和类型进行注入，可以在没有set方法的情况下进行注入。



##### 